<!-- <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
  <div class="col-span-1">
    <app-info-sidebar></app-info-sidebar>
  </div>

  <div class="col-span-1 md:col-span-3 space-y-4">
    <div class="bg-white rounded-lg shadow p-4">
      <h2 class="text-lg font-semibold mb-2">Tạo bài viết</h2>
    </div>
    
    <div class="feed-list space-y-4">
      <app-post-card *ngFor="let post of feedPosts" [post]="post"></app-post-card>
      <div *ngIf="isLoading" class="text-center py-4">Đang tải...</div>
      <button *ngIf="hasMore && !isLoading" 
              (click)="loadMore()" 
              class="w-full py-2 bg-blue-500 text-white rounded">
        Tải thêm
      </button>
    </div>
  </div>
</div> -->

<p-toast></p-toast>

<div class="grid grid-cols-1 md:grid-cols-4 gap-4 bg-gray-100 min-h-screen p-4">
  
  <div class="col-span-1 hidden md:block">
    <app-info-sidebar></app-info-sidebar>
  </div>

  <div class="col-span-1 md:col-span-3 space-y-4">
    
    <div class="bg-white rounded-lg shadow p-4">
      <div class="flex items-center gap-3">
        <p-avatar icon="pi pi-user" shape="circle" size="large" styleClass="bg-gray-200 text-gray-600"></p-avatar>
        
        <div 
          (click)="showCreateModal = true"
          class="flex-1 bg-gray-100 hover:bg-gray-200 cursor-pointer rounded-full px-4 py-3 transition-colors text-gray-500 font-medium select-none">
          Bạn đang nghĩ gì thế?
        </div>
      </div>
      
      <div class="flex items-center justify-between mt-3 pt-3 border-t border-gray-100">
         <button (click)="showCreateModal = true" class="flex items-center gap-2 px-4 py-2 hover:bg-gray-50 rounded-lg text-gray-600 transition-colors">
            <i class="pi pi-image text-green-500 text-xl"></i>
            <span class="font-medium text-sm">Ảnh/Video</span>
         </button>
      </div>
    </div>
    
    <div class="feed-list space-y-4">
      @for (post of feedPosts; track post.postCode) {
        <app-post-card [post]="post"></app-post-card>
      } @empty {
        @if (!isLoading) {
           <div class="text-center p-8 bg-white rounded shadow text-gray-500">
              Chưa có bài viết nào hiển thị.
           </div>
        }
      }

      @if (isLoading) {
        <div class="text-center py-4">
           <i class="pi pi-spin pi-spinner text-2xl text-blue-500"></i>
           <span class="ml-2 text-gray-600">Đang tải...</span>
        </div>
      }

      @if (hasMore && !isLoading && feedPosts.length > 0) {
        <div class="text-center pb-4">
           <button 
              (click)="loadMore()" 
              class="px-6 py-2 bg-white border border-gray-300 text-gray-700 font-medium rounded-full shadow-sm hover:bg-gray-50 transition-colors">
              Xem thêm bài viết cũ hơn
           </button>
        </div>
      }
      
      @if (!hasMore && feedPosts.length > 0) {
         <div class="text-center py-4 text-gray-400 text-sm">
            Bạn đã xem hết tin.
         </div>
      }
    </div>
  </div>
</div>

<app-create-post-dialog 
    [(visible)]="showCreateModal"
    [currentUserAvatar]="currentUser?.avatarUrl || 'assets/images/user-default.jpg'"
    [currentUserName]="currentUser?.fullName || 'Bạn'"
    (postCreated)="onPostCreated($event)">
</app-create-post-dialog>