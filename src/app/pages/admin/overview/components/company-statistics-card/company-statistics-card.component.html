<app-statistic-card
  title="Company Statistics"
  icon="pi pi-building"
  iconColor="text-purple-500"
  iconBackground="bg-purple-100"
  [state]="cardState()"
  [errorMessage]="errorMessage() || 'Failed to load company statistics'"
  emptyMessage="No company data available for the selected time range"
  (retry)="onRetry()"
>
  <div class="company-statistics-content" *ngIf="statisticsData()">
    <div class="metrics-grid grid grid-cols-2 gap-4 mb-6">
      <div class="metric-item">
        <div class="flex items-center justify-between">
          <span class="text-sm text-gray-500">Total Companies</span>
        </div>
        <p class="text-3xl font-bold text-gray-800 mt-1">
          {{ statisticsData()!.totalCompanies | number }}
        </p>
      </div>

      <div class="metric-item">
        <div class="flex items-center justify-between">
          <span class="text-sm text-gray-500">Active Companies</span>
        </div>
        <p class="text-3xl font-bold text-green-600 mt-1">
          {{ statisticsData()!.activeCompanies | number }}
        </p>
        <p class="text-xs text-gray-400 mt-1">
          {{ activeCompaniesPercentage() | number:'1.1-1' }}% of total
        </p>
      </div>

      <div class="metric-item">
        <div class="flex items-center justify-between">
          <span class="text-sm text-gray-500">Inactive Companies</span>
        </div>
        <p class="text-2xl font-semibold text-red-600 mt-1">
          {{ statisticsData()!.inactiveCompanies | number }}
        </p>
      </div>

      <div class="metric-item">
        <div class="flex items-center justify-between">
          <span class="text-sm text-gray-500">New Today</span>
        </div>
        <p class="text-2xl font-semibold text-gray-700 mt-1">
          {{ statisticsData()!.newCompaniesToday | number }}
        </p>
      </div>

      <div class="metric-item">
        <div class="flex items-center justify-between">
          <span class="text-sm text-gray-500">New This Week</span>
          <span 
            *ngIf="newCompaniesThisWeekChange() !== 0"
            [class]="newCompaniesThisWeekChange() > 0 ? 'text-green-600' : 'text-red-600'"
            class="text-xs font-medium flex items-center gap-1"
          >
            <i [class]="newCompaniesThisWeekChange() > 0 ? 'pi pi-arrow-up' : 'pi pi-arrow-down'"></i>
            {{ newCompaniesThisWeekChange() | number:'1.0-0' }}%
          </span>
        </div>
        <p class="text-2xl font-semibold text-gray-700 mt-1">
          {{ statisticsData()!.newCompaniesThisWeek | number }}
        </p>
      </div>

      <div class="metric-item">
        <div class="flex items-center justify-between">
          <span class="text-sm text-gray-500">New This Month</span>
          <span 
            *ngIf="newCompaniesThisMonthChange() !== 0"
            [class]="newCompaniesThisMonthChange() > 0 ? 'text-green-600' : 'text-red-600'"
            class="text-xs font-medium flex items-center gap-1"
          >
            <i [class]="newCompaniesThisMonthChange() > 0 ? 'pi pi-arrow-up' : 'pi pi-arrow-down'"></i>
            {{ newCompaniesThisMonthChange() | number:'1.0-0' }}%
          </span>
        </div>
        <p class="text-2xl font-semibold text-gray-700 mt-1">
          {{ statisticsData()!.newCompaniesThisMonth | number }}
        </p>
      </div>
    </div>

    <div class="charts-section space-y-6">
      <div class="trend-chart" *ngIf="trendChartData()">
        <h4 class="text-sm font-medium text-gray-700 mb-3">Company Growth Trend</h4>
        <app-line-chart
          [data]="trendChartData()"
          [color]="'#8B5CF6'"
          [height]="'200px'"
          [showLegend]="false"
          [showGrid]="true"
        ></app-line-chart>
      </div>

      <div class="ratio-chart" *ngIf="activeInactiveChartData()">
        <h4 class="text-sm font-medium text-gray-700 mb-3">Active vs Inactive Ratio</h4>
        <app-donut-chart
          [data]="activeInactiveChartData()"
          [height]="'250px'"
          [showLegend]="true"
          [showPercentage]="true"
          [cutout]="'65%'"
        ></app-donut-chart>
      </div>

      <div class="no-chart-message" *ngIf="!trendChartData() && !activeInactiveChartData()">
        <p class="text-sm text-gray-400 text-center py-8">
          No chart data available
        </p>
      </div>
    </div>
  </div>
</app-statistic-card>
