<app-statistic-card
  title="User Statistics"
  icon="pi pi-users"
  iconColor="text-blue-500"
  iconBackground="bg-blue-100"
  [state]="cardState()"
  [errorMessage]="errorMessage() || 'Failed to load user statistics'"
  emptyMessage="No user data available for the selected time range"
  (retry)="onRetry()"
>
  <div class="user-statistics-content" *ngIf="statisticsData()">
    <div class="metrics-grid grid grid-cols-2 gap-4 mb-6">
      <div class="metric-item">
        <div class="flex items-center justify-between">
          <span class="text-sm text-gray-500">Total Users</span>
        </div>
        <p class="text-3xl font-bold text-gray-800 mt-1">
          {{ statisticsData()!.totalUsers | number }}
        </p>
      </div>

      <div class="metric-item">
        <div class="flex items-center justify-between">
          <span class="text-sm text-gray-500">Active Users</span>
        </div>
        <p class="text-3xl font-bold text-green-600 mt-1">
          {{ statisticsData()!.activeUsers | number }}
        </p>
        <p class="text-xs text-gray-400 mt-1">
          {{ (statisticsData()!.activeUsers / statisticsData()!.totalUsers * 100) | number:'1.1-1' }}% of total
        </p>
      </div>

      <div class="metric-item">
        <div class="flex items-center justify-between">
          <span class="text-sm text-gray-500">New Today</span>
        </div>
        <p class="text-2xl font-semibold text-gray-700 mt-1">
          {{ statisticsData()!.newUsersToday | number }}
        </p>
      </div>

      <div class="metric-item">
        <div class="flex items-center justify-between">
          <span class="text-sm text-gray-500">New This Week</span>
          <span 
            *ngIf="newUsersThisWeekChange() !== 0"
            [class]="newUsersThisWeekChange() > 0 ? 'text-green-600' : 'text-red-600'"
            class="text-xs font-medium flex items-center gap-1"
          >
            <i [class]="newUsersThisWeekChange() > 0 ? 'pi pi-arrow-up' : 'pi pi-arrow-down'"></i>
            {{ newUsersThisWeekChange() | number:'1.0-0' }}%
          </span>
        </div>
        <p class="text-2xl font-semibold text-gray-700 mt-1">
          {{ statisticsData()!.newUsersThisWeek | number }}
        </p>
      </div>

      <div class="metric-item col-span-2">
        <div class="flex items-center justify-between">
          <span class="text-sm text-gray-500">New This Month</span>
          <span 
            *ngIf="newUsersThisMonthChange() !== 0"
            [class]="newUsersThisMonthChange() > 0 ? 'text-green-600' : 'text-red-600'"
            class="text-xs font-medium flex items-center gap-1"
          >
            <i [class]="newUsersThisMonthChange() > 0 ? 'pi pi-arrow-up' : 'pi pi-arrow-down'"></i>
            {{ newUsersThisMonthChange() | number:'1.0-0' }}%
          </span>
        </div>
        <p class="text-2xl font-semibold text-gray-700 mt-1">
          {{ statisticsData()!.newUsersThisMonth | number }}
        </p>
      </div>
    </div>

    <div class="chart-section" *ngIf="chartData()">
      <h4 class="text-sm font-medium text-gray-700 mb-3">User Growth Trend</h4>
      <app-line-chart
        [data]="chartData()"
        [color]="'#3B82F6'"
        [height]="'250px'"
        [showLegend]="false"
        [showGrid]="true"
      ></app-line-chart>
    </div>

    <div class="no-chart-message" *ngIf="!chartData()">
      <p class="text-sm text-gray-400 text-center py-8">
        No trend data available
      </p>
    </div>
  </div>
</app-statistic-card>
