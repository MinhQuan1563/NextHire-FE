<div class="admin-overview-container p-4 md:p-6">
  <div class="header-section mb-6">
    <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-4">
      <div>
        <h1 class="text-3xl font-bold text-gray-800 mb-2">Dashboard Overview</h1>
        <p class="text-gray-600">Monitor key metrics and statistics across your platform</p>
      </div>
      
      <div class="flex items-center gap-3">
        <div class="text-sm text-gray-500" *ngIf="lastUpdated()">
          <i class="pi pi-clock mr-1"></i>
          <span>{{ lastUpdatedText() }}</span>
        </div>
        
        <p-button
          icon="pi pi-refresh"
          [loading]="isLoading()"
          (onClick)="onRefresh()"
          severity="secondary"
          [outlined]="true"
          size="small"
          [attr.aria-label]="'Refresh dashboard data'"
        ></p-button>
        
        <p-button
          [icon]="autoRefreshEnabled() ? 'pi pi-pause' : 'pi pi-play'"
          [label]="autoRefreshEnabled() ? 'Auto-refresh On' : 'Auto-refresh Off'"
          (onClick)="toggleAutoRefresh()"
          [severity]="autoRefreshEnabled() ? 'success' : 'secondary'"
          [outlined]="!autoRefreshEnabled()"
          size="small"
          [attr.aria-label]="'Toggle auto-refresh'"
        ></p-button>
      </div>
    </div>

    <div class="time-range-section">
      <app-time-range-selector
        (timeRangeChange)="onTimeRangeChange($event)"
      ></app-time-range-selector>
    </div>
  </div>

  <div *ngIf="error()" class="error-message mb-6">
    <p-message 
      severity="error" 
      [text]="error()!"
      styleClass="w-full"
    >
      <ng-template pTemplate>
        <div class="flex items-center justify-between w-full">
          <div class="flex items-center gap-2">
            <i class="pi pi-exclamation-circle text-xl"></i>
            <span>{{ error() }}</span>
          </div>
          <p-button
            label="Retry"
            icon="pi pi-refresh"
            (onClick)="onRetry()"
            severity="danger"
            [text]="true"
            size="small"
          ></p-button>
        </div>
      </ng-template>
    </p-message>
  </div>

  <div class="loading-overlay" *ngIf="isLoading() && !dashboardData()">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div class="skeleton-card bg-white rounded-lg shadow p-6 h-96" *ngFor="let i of [1,2,3,4]">
        <div class="animate-pulse">
          <div class="flex items-center gap-3 mb-4">
            <div class="w-12 h-12 bg-gray-200 rounded-lg"></div>
            <div class="h-6 bg-gray-200 rounded w-1/3"></div>
          </div>
          <div class="space-y-3">
            <div class="h-4 bg-gray-200 rounded w-full"></div>
            <div class="h-4 bg-gray-200 rounded w-5/6"></div>
            <div class="h-4 bg-gray-200 rounded w-4/6"></div>
            <div class="h-48 bg-gray-200 rounded w-full mt-4"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="dashboard-grid" *ngIf="!isLoading() || dashboardData()">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div class="user-statistics-section">
        <app-user-statistics-card
          [data]="dashboardData()?.userStatistics || null"
          [loading]="isLoading()"
          [error]="error()"
        ></app-user-statistics-card>
      </div>

      <div class="job-statistics-section">
        <app-job-statistics-card
          [data]="dashboardData()?.jobStatistics || null"
          [loading]="isLoading()"
          [error]="error()"
        ></app-job-statistics-card>
      </div>

      <div class="company-statistics-section">
        <app-company-statistics-card
          [data]="dashboardData()?.companyStatistics || null"
          [loading]="isLoading()"
          [error]="error()"
        ></app-company-statistics-card>
      </div>

      <div class="application-statistics-section">
        <app-application-statistics-card
          [data]="dashboardData()?.applicationStatistics || null"
          [loading]="isLoading()"
          [error]="error()"
        ></app-application-statistics-card>
      </div>
    </div>
  </div>
</div>
