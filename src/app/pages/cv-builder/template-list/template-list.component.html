<div class="container mx-auto px-4 py-8">
  <div class="flex justify-between items-center mb-6">
    <h1 class="text-3xl font-bold">Choose Your CV Template</h1>
    @if (isAdmin()) {
      <p-button
        class="bg-green-500 text-white rounded-lg px-4 py-2"
        label="Tạo mới"
        icon="pi pi-plus"
        (onClick)="navigateToCreate()"
        [disabled]="isLoading()"
      ></p-button>
    }
  </div>
  
  @if (isLoading()) {
    <div class="flex flex-col items-center justify-center py-12">
      <p-progressSpinner 
        [style]="{width: '50px', height: '50px'}" 
        strokeWidth="4"
        animationDuration=".5s">
      </p-progressSpinner>
      <p class="text-gray-500 text-lg mt-4">Đang tải templates...</p>
    </div>
  } @else if (templates.length === 0) {
    <div class="text-center py-12">
      <p class="text-gray-500 text-lg">Không có template nào</p>
    </div>
  } @else {
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
      @for (template of templates; track template.templateCode) {
        <div
          class="bg-white rounded-lg shadow-lg overflow-hidden cursor-pointer hover:shadow-xl transition-shadow"
          (click)="navigateToTemplate(template.templateCode)"
        >
          <!-- <img
            [src]="template.sampleFileUrl"
            [alt]="template.name"
            class="w-full h-48 object-cover"
            onerror="this.src='data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'400\' height=\'300\'%3E%3Crect fill=\'%23f0f0f0\' width=\'400\' height=\'300\'/%3E%3Ctext x=\'50%25\' y=\'50%25\' text-anchor=\'middle\' dy=\'.3em\' fill=\'%23999\' font-family=\'Arial\' font-size=\'16\'%3ENo Image%3C/text%3E%3C/svg%3E'"
          /> -->
          <div class="p-4">
            <h3 class="text-xl font-semibold mb-2">{{ template.name }}</h3>
            <p class="text-gray-600">{{ template.description }}</p>
            <div class="mt-2 flex justify-between items-center">
              <span class="text-sm text-gray-500">{{
                template.type | cvTemplateType
              }}</span>
              <span
                [class]="
                  template.isPublished ? 'text-green-600' : 'text-gray-400'
                "
              >
                {{ template.isPublished ? "Published" : "Draft" }}
              </span>
            </div>
          </div>
        </div>
      }
    </div>
    
    <p-paginator
      [first]="first()"
      [rows]="rows()"
      [totalRecords]="totalRecords()"
      [rowsPerPageOptions]="rowsPerPageOptions"
      (onPageChange)="onPageChange($event)"
      [showCurrentPageReport]="true"
      currentPageReportTemplate="Hiển thị {first} - {last} của {totalRecords} template"
      styleClass="p-paginator-custom">
    </p-paginator>
  }
</div>
