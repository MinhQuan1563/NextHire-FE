<!-- Layout Configuration -->
<div class="config-section">
  <div class="section-header">
    <button class="btn btn-sm btn-primary mb-3" (click)="addRow()">
      <i class="icon">‚ûï</i>
      Th√™m d√≤ng
    </button>
  </div>

  <!-- Layout Preview -->
  <div class="layout-preview">
    <div
      *ngFor="
        let row of configForm.rows;
        let rowIndex = index;
        trackBy: trackByRow
      "
      class="layout-row"
    >
      <!-- Row Header -->
      <div class="row-header">
        <div class="row-info">
          <span class="row-label">D√≤ng {{ rowIndex + 1 }}</span>
          <span class="row-meta"
            >{{ row.columns.length }} c·ªôt ‚Ä¢ {{ getTotalWidth(row) }}% t·ªïng chi·ªÅu
            r·ªông</span
          >
        </div>
        <div class="row-actions">
          <button
            class="btn btn-xs btn-secondary"
            (click)="addColumn(rowIndex)"
            [disabled]="row.columns.length >= 4"
          >
            <i class="icon">‚ûï</i>
            Th√™m c·ªôt
          </button>
          <button
            class="btn btn-xs btn-danger"
            (click)="removeRow(rowIndex)"
            [disabled]="configForm.rows!.length <= 1"
          >
            <i class="icon">üóëÔ∏è</i>
            X√≥a d√≤ng
          </button>
        </div>
      </div>

      <!-- Row Columns -->
      <div class="row-columns">
        <div
          *ngFor="
            let column of row.columns;
            let columnIndex = index;
            trackBy: trackByColumn
          "
          class="layout-column"
          [style.flex]="'0 0 ' + column.widthPercentage + '%'"
        >
          <div class="column-header">
            <span class="column-label">C·ªôt {{ columnIndex + 1 }}</span>
            <button
              class="btn btn-xs btn-danger"
              (click)="removeColumn(rowIndex, columnIndex)"
              [disabled]="row.columns.length <= 1"
            >
              ‚úï
            </button>
          </div>

          <div class="column-body">
            <div class="width-control">
              <label>Chi·ªÅu r·ªông:</label>
              <div class="width-input-group">
                <input
                  type="range"
                  [value]="column.widthPercentage"
                  (input)="onWidthChange(rowIndex, columnIndex, $event)"
                  min="10"
                  max="90"
                  class="width-slider"
                />
                <input
                  type="number"
                  [value]="column.widthPercentage"
                  (input)="onWidthChange(rowIndex, columnIndex, $event)"
                  min="10"
                  max="90"
                  class="width-number"
                />
                <span class="width-unit">%</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Layout Summary -->
  <div class="layout-summary">
    <div class="summary-item">
      <strong>T·ªïng d√≤ng:</strong> {{ configForm.rows?.length || 0 }}
    </div>
    <div class="summary-item">
      <strong>C·ªôt t·ªëi ƒëa:</strong> {{ configForm.totalColumns }}
    </div>
    <div class="summary-item">
      <strong>T·ªïng v√πng k√©o th·∫£:</strong>
      {{ getTotalDropZones() }}
    </div>
  </div>
  <div class="flex justify-end gap-2 mt-4">
    <button class="btn btn-primary" (click)="onSave()">L∆∞u</button>
  </div>
</div>
